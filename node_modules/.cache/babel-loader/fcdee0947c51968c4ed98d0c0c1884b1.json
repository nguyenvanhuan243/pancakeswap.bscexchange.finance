{"ast":null,"code":"var _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$();\n\nimport { useCallback, useEffect, useState } from 'react';\nimport { useWeb3React } from '@web3-react/core';\nimport { ethers } from 'ethers';\nimport BigNumber from 'bignumber.js';\nimport { useAppDispatch } from 'state';\nimport { updateUserAllowance } from 'state/actions';\nimport { useTranslation } from 'contexts/Localization';\nimport { useCake, useSousChef, useCakeVaultContract } from 'hooks/useContract';\nimport useToast from 'hooks/useToast';\nimport useLastUpdated from 'hooks/useLastUpdated';\nimport { useCallWithGasPrice } from 'hooks/useCallWithGasPrice';\nexport const useApprovePool = (lpContract, sousId, earningTokenSymbol) => {\n  _s();\n\n  const [requestedApproval, setRequestedApproval] = useState(false);\n  const {\n    toastSuccess,\n    toastError\n  } = useToast();\n  const {\n    callWithGasPrice\n  } = useCallWithGasPrice();\n  const {\n    t\n  } = useTranslation();\n  const dispatch = useAppDispatch();\n  const {\n    account\n  } = useWeb3React();\n  const sousChefContract = useSousChef(sousId);\n  const handleApprove = useCallback(async () => {\n    try {\n      setRequestedApproval(true);\n      const tx = await callWithGasPrice(lpContract, 'approve', [sousChefContract.address, ethers.constants.MaxUint256]);\n      const receipt = await tx.wait();\n      dispatch(updateUserAllowance(sousId, account));\n\n      if (receipt.status) {\n        toastSuccess(t('Contract Enabled'), t('You can now stake in the %symbol% pool!', {\n          symbol: earningTokenSymbol\n        }));\n        setRequestedApproval(false);\n      } else {\n        // user rejected tx or didn't go thru\n        toastError(t('Error'), t('Please try again. Confirm the transaction and make sure you are paying enough gas!'));\n        setRequestedApproval(false);\n      }\n    } catch (e) {\n      console.error(e);\n      toastError(t('Error'), t('Please try again. Confirm the transaction and make sure you are paying enough gas!'));\n    }\n  }, [account, dispatch, lpContract, sousChefContract, sousId, earningTokenSymbol, t, toastError, toastSuccess, callWithGasPrice]);\n  return {\n    handleApprove,\n    requestedApproval\n  };\n}; // Approve CAKE auto pool\n\n_s(useApprovePool, \"X+A6ECmrnRSSl/spYPJPl+cHGek=\", false, function () {\n  return [useToast, useCallWithGasPrice, useTranslation, useAppDispatch, useWeb3React, useSousChef];\n});\n\nexport const useVaultApprove = setLastUpdated => {\n  _s2();\n\n  const [requestedApproval, setRequestedApproval] = useState(false);\n  const {\n    t\n  } = useTranslation();\n  const {\n    toastSuccess,\n    toastError\n  } = useToast();\n  const cakeVaultContract = useCakeVaultContract();\n  const {\n    callWithGasPrice\n  } = useCallWithGasPrice();\n  const cakeContract = useCake();\n\n  const handleApprove = async () => {\n    const tx = await callWithGasPrice(cakeContract, 'approve', [cakeVaultContract.address, ethers.constants.MaxUint256]);\n    setRequestedApproval(true);\n    const receipt = await tx.wait();\n\n    if (receipt.status) {\n      toastSuccess(t('Contract Enabled'), t('You can now stake in the %symbol% vault!', {\n        symbol: 'CAKE'\n      }));\n      setLastUpdated();\n      setRequestedApproval(false);\n    } else {\n      toastError(t('Error'), t('Please try again. Confirm the transaction and make sure you are paying enough gas!'));\n      setRequestedApproval(false);\n    }\n  };\n\n  return {\n    handleApprove,\n    requestedApproval\n  };\n};\n\n_s2(useVaultApprove, \"ABhrpaVjXnfEoStsQaxKg4Eh8YA=\", false, function () {\n  return [useTranslation, useToast, useCakeVaultContract, useCallWithGasPrice, useCake];\n});\n\nexport const useCheckVaultApprovalStatus = () => {\n  _s3();\n\n  const [isVaultApproved, setIsVaultApproved] = useState(false);\n  const {\n    account\n  } = useWeb3React();\n  const cakeContract = useCake();\n  const cakeVaultContract = useCakeVaultContract();\n  const {\n    lastUpdated,\n    setLastUpdated\n  } = useLastUpdated();\n  useEffect(() => {\n    const checkApprovalStatus = async () => {\n      try {\n        const response = await cakeContract.allowance(account, cakeVaultContract.address);\n        const currentAllowance = new BigNumber(response.toString());\n        setIsVaultApproved(currentAllowance.gt(0));\n      } catch (error) {\n        setIsVaultApproved(false);\n      }\n    };\n\n    checkApprovalStatus();\n  }, [account, cakeContract, cakeVaultContract, lastUpdated]);\n  return {\n    isVaultApproved,\n    setLastUpdated\n  };\n};\n\n_s3(useCheckVaultApprovalStatus, \"DYtHZy3b2IMwKe/ETQokUhwfsfM=\", false, function () {\n  return [useWeb3React, useCake, useCakeVaultContract, useLastUpdated];\n});","map":{"version":3,"sources":["/Users/nguyenvanhuan243/Documents/apphocvienstock/src/views/Pools/hooks/useApprove.ts"],"names":["useCallback","useEffect","useState","useWeb3React","ethers","BigNumber","useAppDispatch","updateUserAllowance","useTranslation","useCake","useSousChef","useCakeVaultContract","useToast","useLastUpdated","useCallWithGasPrice","useApprovePool","lpContract","sousId","earningTokenSymbol","requestedApproval","setRequestedApproval","toastSuccess","toastError","callWithGasPrice","t","dispatch","account","sousChefContract","handleApprove","tx","address","constants","MaxUint256","receipt","wait","status","symbol","e","console","error","useVaultApprove","setLastUpdated","cakeVaultContract","cakeContract","useCheckVaultApprovalStatus","isVaultApproved","setIsVaultApproved","lastUpdated","checkApprovalStatus","response","allowance","currentAllowance","toString","gt"],"mappings":";;;;AAAA,SAASA,WAAT,EAAsBC,SAAtB,EAAiCC,QAAjC,QAAiD,OAAjD;AACA,SAASC,YAAT,QAA6B,kBAA7B;AACA,SAASC,MAAT,QAAiC,QAAjC;AACA,OAAOC,SAAP,MAAsB,cAAtB;AACA,SAASC,cAAT,QAA+B,OAA/B;AACA,SAASC,mBAAT,QAAoC,eAApC;AACA,SAASC,cAAT,QAA+B,uBAA/B;AACA,SAASC,OAAT,EAAkBC,WAAlB,EAA+BC,oBAA/B,QAA2D,mBAA3D;AACA,OAAOC,QAAP,MAAqB,gBAArB;AACA,OAAOC,cAAP,MAA2B,sBAA3B;AACA,SAASC,mBAAT,QAAoC,2BAApC;AAEA,OAAO,MAAMC,cAAc,GAAG,CAACC,UAAD,EAAuBC,MAAvB,EAA+BC,kBAA/B,KAAsD;AAAA;;AAClF,QAAM,CAACC,iBAAD,EAAoBC,oBAApB,IAA4ClB,QAAQ,CAAC,KAAD,CAA1D;AACA,QAAM;AAAEmB,IAAAA,YAAF;AAAgBC,IAAAA;AAAhB,MAA+BV,QAAQ,EAA7C;AACA,QAAM;AAAEW,IAAAA;AAAF,MAAuBT,mBAAmB,EAAhD;AACA,QAAM;AAAEU,IAAAA;AAAF,MAAQhB,cAAc,EAA5B;AACA,QAAMiB,QAAQ,GAAGnB,cAAc,EAA/B;AACA,QAAM;AAAEoB,IAAAA;AAAF,MAAcvB,YAAY,EAAhC;AACA,QAAMwB,gBAAgB,GAAGjB,WAAW,CAACO,MAAD,CAApC;AAEA,QAAMW,aAAa,GAAG5B,WAAW,CAAC,YAAY;AAC5C,QAAI;AACFoB,MAAAA,oBAAoB,CAAC,IAAD,CAApB;AACA,YAAMS,EAAE,GAAG,MAAMN,gBAAgB,CAACP,UAAD,EAAa,SAAb,EAAwB,CAACW,gBAAgB,CAACG,OAAlB,EAA2B1B,MAAM,CAAC2B,SAAP,CAAiBC,UAA5C,CAAxB,CAAjC;AACA,YAAMC,OAAO,GAAG,MAAMJ,EAAE,CAACK,IAAH,EAAtB;AAEAT,MAAAA,QAAQ,CAAClB,mBAAmB,CAACU,MAAD,EAASS,OAAT,CAApB,CAAR;;AACA,UAAIO,OAAO,CAACE,MAAZ,EAAoB;AAClBd,QAAAA,YAAY,CACVG,CAAC,CAAC,kBAAD,CADS,EAEVA,CAAC,CAAC,yCAAD,EAA4C;AAAEY,UAAAA,MAAM,EAAElB;AAAV,SAA5C,CAFS,CAAZ;AAIAE,QAAAA,oBAAoB,CAAC,KAAD,CAApB;AACD,OAND,MAMO;AACL;AACAE,QAAAA,UAAU,CAACE,CAAC,CAAC,OAAD,CAAF,EAAaA,CAAC,CAAC,oFAAD,CAAd,CAAV;AACAJ,QAAAA,oBAAoB,CAAC,KAAD,CAApB;AACD;AACF,KAjBD,CAiBE,OAAOiB,CAAP,EAAU;AACVC,MAAAA,OAAO,CAACC,KAAR,CAAcF,CAAd;AACAf,MAAAA,UAAU,CAACE,CAAC,CAAC,OAAD,CAAF,EAAaA,CAAC,CAAC,oFAAD,CAAd,CAAV;AACD;AACF,GAtBgC,EAsB9B,CACDE,OADC,EAEDD,QAFC,EAGDT,UAHC,EAIDW,gBAJC,EAKDV,MALC,EAMDC,kBANC,EAODM,CAPC,EAQDF,UARC,EASDD,YATC,EAUDE,gBAVC,CAtB8B,CAAjC;AAmCA,SAAO;AAAEK,IAAAA,aAAF;AAAiBT,IAAAA;AAAjB,GAAP;AACD,CA7CM,C,CA+CP;;GA/CaJ,c;UAE0BH,Q,EACRE,mB,EACfN,c,EACGF,c,EACGH,Y,EACKO,W;;;AAyC3B,OAAO,MAAM8B,eAAe,GAAIC,cAAD,IAAgC;AAAA;;AAC7D,QAAM,CAACtB,iBAAD,EAAoBC,oBAApB,IAA4ClB,QAAQ,CAAC,KAAD,CAA1D;AACA,QAAM;AAAEsB,IAAAA;AAAF,MAAQhB,cAAc,EAA5B;AACA,QAAM;AAAEa,IAAAA,YAAF;AAAgBC,IAAAA;AAAhB,MAA+BV,QAAQ,EAA7C;AACA,QAAM8B,iBAAiB,GAAG/B,oBAAoB,EAA9C;AACA,QAAM;AAAEY,IAAAA;AAAF,MAAuBT,mBAAmB,EAAhD;AACA,QAAM6B,YAAY,GAAGlC,OAAO,EAA5B;;AAEA,QAAMmB,aAAa,GAAG,YAAY;AAChC,UAAMC,EAAE,GAAG,MAAMN,gBAAgB,CAACoB,YAAD,EAAe,SAAf,EAA0B,CAACD,iBAAiB,CAACZ,OAAnB,EAA4B1B,MAAM,CAAC2B,SAAP,CAAiBC,UAA7C,CAA1B,CAAjC;AACAZ,IAAAA,oBAAoB,CAAC,IAAD,CAApB;AACA,UAAMa,OAAO,GAAG,MAAMJ,EAAE,CAACK,IAAH,EAAtB;;AACA,QAAID,OAAO,CAACE,MAAZ,EAAoB;AAClBd,MAAAA,YAAY,CAACG,CAAC,CAAC,kBAAD,CAAF,EAAwBA,CAAC,CAAC,0CAAD,EAA6C;AAAEY,QAAAA,MAAM,EAAE;AAAV,OAA7C,CAAzB,CAAZ;AACAK,MAAAA,cAAc;AACdrB,MAAAA,oBAAoB,CAAC,KAAD,CAApB;AACD,KAJD,MAIO;AACLE,MAAAA,UAAU,CAACE,CAAC,CAAC,OAAD,CAAF,EAAaA,CAAC,CAAC,oFAAD,CAAd,CAAV;AACAJ,MAAAA,oBAAoB,CAAC,KAAD,CAApB;AACD;AACF,GAZD;;AAcA,SAAO;AAAEQ,IAAAA,aAAF;AAAiBT,IAAAA;AAAjB,GAAP;AACD,CAvBM;;IAAMqB,e;UAEGhC,c,EACuBI,Q,EACXD,oB,EACGG,mB,EACRL,O;;;AAmBvB,OAAO,MAAMmC,2BAA2B,GAAG,MAAM;AAAA;;AAC/C,QAAM,CAACC,eAAD,EAAkBC,kBAAlB,IAAwC5C,QAAQ,CAAC,KAAD,CAAtD;AACA,QAAM;AAAEwB,IAAAA;AAAF,MAAcvB,YAAY,EAAhC;AACA,QAAMwC,YAAY,GAAGlC,OAAO,EAA5B;AACA,QAAMiC,iBAAiB,GAAG/B,oBAAoB,EAA9C;AACA,QAAM;AAAEoC,IAAAA,WAAF;AAAeN,IAAAA;AAAf,MAAkC5B,cAAc,EAAtD;AACAZ,EAAAA,SAAS,CAAC,MAAM;AACd,UAAM+C,mBAAmB,GAAG,YAAY;AACtC,UAAI;AACF,cAAMC,QAAQ,GAAG,MAAMN,YAAY,CAACO,SAAb,CAAuBxB,OAAvB,EAAgCgB,iBAAiB,CAACZ,OAAlD,CAAvB;AACA,cAAMqB,gBAAgB,GAAG,IAAI9C,SAAJ,CAAc4C,QAAQ,CAACG,QAAT,EAAd,CAAzB;AACAN,QAAAA,kBAAkB,CAACK,gBAAgB,CAACE,EAAjB,CAAoB,CAApB,CAAD,CAAlB;AACD,OAJD,CAIE,OAAOd,KAAP,EAAc;AACdO,QAAAA,kBAAkB,CAAC,KAAD,CAAlB;AACD;AACF,KARD;;AAUAE,IAAAA,mBAAmB;AACpB,GAZQ,EAYN,CAACtB,OAAD,EAAUiB,YAAV,EAAwBD,iBAAxB,EAA2CK,WAA3C,CAZM,CAAT;AAcA,SAAO;AAAEF,IAAAA,eAAF;AAAmBJ,IAAAA;AAAnB,GAAP;AACD,CArBM;;IAAMG,2B;UAESzC,Y,EACCM,O,EACKE,oB,EACcE,c","sourcesContent":["import { useCallback, useEffect, useState } from 'react'\nimport { useWeb3React } from '@web3-react/core'\nimport { ethers, Contract } from 'ethers'\nimport BigNumber from 'bignumber.js'\nimport { useAppDispatch } from 'state'\nimport { updateUserAllowance } from 'state/actions'\nimport { useTranslation } from 'contexts/Localization'\nimport { useCake, useSousChef, useCakeVaultContract } from 'hooks/useContract'\nimport useToast from 'hooks/useToast'\nimport useLastUpdated from 'hooks/useLastUpdated'\nimport { useCallWithGasPrice } from 'hooks/useCallWithGasPrice'\n\nexport const useApprovePool = (lpContract: Contract, sousId, earningTokenSymbol) => {\n  const [requestedApproval, setRequestedApproval] = useState(false)\n  const { toastSuccess, toastError } = useToast()\n  const { callWithGasPrice } = useCallWithGasPrice()\n  const { t } = useTranslation()\n  const dispatch = useAppDispatch()\n  const { account } = useWeb3React()\n  const sousChefContract = useSousChef(sousId)\n\n  const handleApprove = useCallback(async () => {\n    try {\n      setRequestedApproval(true)\n      const tx = await callWithGasPrice(lpContract, 'approve', [sousChefContract.address, ethers.constants.MaxUint256])\n      const receipt = await tx.wait()\n\n      dispatch(updateUserAllowance(sousId, account))\n      if (receipt.status) {\n        toastSuccess(\n          t('Contract Enabled'),\n          t('You can now stake in the %symbol% pool!', { symbol: earningTokenSymbol }),\n        )\n        setRequestedApproval(false)\n      } else {\n        // user rejected tx or didn't go thru\n        toastError(t('Error'), t('Please try again. Confirm the transaction and make sure you are paying enough gas!'))\n        setRequestedApproval(false)\n      }\n    } catch (e) {\n      console.error(e)\n      toastError(t('Error'), t('Please try again. Confirm the transaction and make sure you are paying enough gas!'))\n    }\n  }, [\n    account,\n    dispatch,\n    lpContract,\n    sousChefContract,\n    sousId,\n    earningTokenSymbol,\n    t,\n    toastError,\n    toastSuccess,\n    callWithGasPrice,\n  ])\n\n  return { handleApprove, requestedApproval }\n}\n\n// Approve CAKE auto pool\nexport const useVaultApprove = (setLastUpdated: () => void) => {\n  const [requestedApproval, setRequestedApproval] = useState(false)\n  const { t } = useTranslation()\n  const { toastSuccess, toastError } = useToast()\n  const cakeVaultContract = useCakeVaultContract()\n  const { callWithGasPrice } = useCallWithGasPrice()\n  const cakeContract = useCake()\n\n  const handleApprove = async () => {\n    const tx = await callWithGasPrice(cakeContract, 'approve', [cakeVaultContract.address, ethers.constants.MaxUint256])\n    setRequestedApproval(true)\n    const receipt = await tx.wait()\n    if (receipt.status) {\n      toastSuccess(t('Contract Enabled'), t('You can now stake in the %symbol% vault!', { symbol: 'CAKE' }))\n      setLastUpdated()\n      setRequestedApproval(false)\n    } else {\n      toastError(t('Error'), t('Please try again. Confirm the transaction and make sure you are paying enough gas!'))\n      setRequestedApproval(false)\n    }\n  }\n\n  return { handleApprove, requestedApproval }\n}\n\nexport const useCheckVaultApprovalStatus = () => {\n  const [isVaultApproved, setIsVaultApproved] = useState(false)\n  const { account } = useWeb3React()\n  const cakeContract = useCake()\n  const cakeVaultContract = useCakeVaultContract()\n  const { lastUpdated, setLastUpdated } = useLastUpdated()\n  useEffect(() => {\n    const checkApprovalStatus = async () => {\n      try {\n        const response = await cakeContract.allowance(account, cakeVaultContract.address)\n        const currentAllowance = new BigNumber(response.toString())\n        setIsVaultApproved(currentAllowance.gt(0))\n      } catch (error) {\n        setIsVaultApproved(false)\n      }\n    }\n\n    checkApprovalStatus()\n  }, [account, cakeContract, cakeVaultContract, lastUpdated])\n\n  return { isVaultApproved, setLastUpdated }\n}\n"]},"metadata":{},"sourceType":"module"}