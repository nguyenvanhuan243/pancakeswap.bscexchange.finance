{"ast":null,"code":"import _regeneratorRuntime from\"/Users/nguyenvanhuan243/Documents/pancake-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/nguyenvanhuan243/Documents/pancake-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{useCallback}from'react';import{useWeb3React,UnsupportedChainIdError}from'@web3-react/core';import{NoBscProviderError}from'@binance-chain/bsc-connector';import{NoEthereumProviderError,UserRejectedRequestError as UserRejectedRequestErrorInjected}from'@web3-react/injected-connector';import{UserRejectedRequestError as UserRejectedRequestErrorWalletConnect,WalletConnectConnector}from'@web3-react/walletconnect-connector';import{connectorLocalStorageKey}from'@pancakeswap/uikit';import{connectorsByName}from'utils/web3React';import{setupNetwork}from'utils/wallet';import useToast from'hooks/useToast';import{profileClear}from'state/profile';import{useAppDispatch}from'state';import{useTranslation}from'contexts/Localization';var useAuth=function useAuth(){var _useTranslation=useTranslation(),t=_useTranslation.t;var dispatch=useAppDispatch();var _useWeb3React=useWeb3React(),activate=_useWeb3React.activate,deactivate=_useWeb3React.deactivate;var _useToast=useToast(),toastError=_useToast.toastError;var login=useCallback(function(connectorID){var connector=connectorsByName[connectorID];if(connector){activate(connector,/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(error){var hasSetup,walletConnector;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(error instanceof UnsupportedChainIdError)){_context.next=7;break;}_context.next=3;return setupNetwork();case 3:hasSetup=_context.sent;if(hasSetup){activate(connector);}_context.next=9;break;case 7:window.localStorage.removeItem(connectorLocalStorageKey);if(error instanceof NoEthereumProviderError||error instanceof NoBscProviderError){toastError(t('Provider Error'),t('No provider was found'));}else if(error instanceof UserRejectedRequestErrorInjected||error instanceof UserRejectedRequestErrorWalletConnect){if(connector instanceof WalletConnectConnector){walletConnector=connector;walletConnector.walletConnectProvider=null;}toastError(t('Authorization Error'),t('Please authorize to access your account'));}else{toastError(error.name,error.message);}case 9:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());}else{toastError(t('Unable to find connector'),t('The connector config is wrong'));}},[t,activate,toastError]);var logout=useCallback(function(){dispatch(profileClear());deactivate();// This localStorage key is set by @web3-react/walletconnect-connector\nif(window.localStorage.getItem('walletconnect')){connectorsByName.walletconnect.close();connectorsByName.walletconnect.walletConnectProvider=null;}},[deactivate,dispatch]);return{login:login,logout:logout};};export default useAuth;","map":{"version":3,"sources":["/Users/nguyenvanhuan243/Documents/pancake-frontend/src/hooks/useAuth.ts"],"names":["useCallback","useWeb3React","UnsupportedChainIdError","NoBscProviderError","NoEthereumProviderError","UserRejectedRequestError","UserRejectedRequestErrorInjected","UserRejectedRequestErrorWalletConnect","WalletConnectConnector","connectorLocalStorageKey","connectorsByName","setupNetwork","useToast","profileClear","useAppDispatch","useTranslation","useAuth","t","dispatch","activate","deactivate","toastError","login","connectorID","connector","error","hasSetup","window","localStorage","removeItem","walletConnector","walletConnectProvider","name","message","logout","getItem","walletconnect","close"],"mappings":"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","sourcesContent":["import { useCallback } from 'react'\nimport { useWeb3React, UnsupportedChainIdError } from '@web3-react/core'\nimport { NoBscProviderError } from '@binance-chain/bsc-connector'\nimport {\n  NoEthereumProviderError,\n  UserRejectedRequestError as UserRejectedRequestErrorInjected,\n} from '@web3-react/injected-connector'\nimport {\n  UserRejectedRequestError as UserRejectedRequestErrorWalletConnect,\n  WalletConnectConnector,\n} from '@web3-react/walletconnect-connector'\nimport { ConnectorNames, connectorLocalStorageKey } from '@pancakeswap/uikit'\nimport { connectorsByName } from 'utils/web3React'\nimport { setupNetwork } from 'utils/wallet'\nimport useToast from 'hooks/useToast'\nimport { profileClear } from 'state/profile'\nimport { useAppDispatch } from 'state'\nimport { useTranslation } from 'contexts/Localization'\n\nconst useAuth = () => {\n  const { t } = useTranslation()\n  const dispatch = useAppDispatch()\n  const { activate, deactivate } = useWeb3React()\n  const { toastError } = useToast()\n\n  const login = useCallback(\n    (connectorID: ConnectorNames) => {\n      const connector = connectorsByName[connectorID]\n      if (connector) {\n        activate(connector, async (error: Error) => {\n          if (error instanceof UnsupportedChainIdError) {\n            const hasSetup = await setupNetwork()\n            if (hasSetup) {\n              activate(connector)\n            }\n          } else {\n            window.localStorage.removeItem(connectorLocalStorageKey)\n            if (error instanceof NoEthereumProviderError || error instanceof NoBscProviderError) {\n              toastError(t('Provider Error'), t('No provider was found'))\n            } else if (\n              error instanceof UserRejectedRequestErrorInjected ||\n              error instanceof UserRejectedRequestErrorWalletConnect\n            ) {\n              if (connector instanceof WalletConnectConnector) {\n                const walletConnector = connector as WalletConnectConnector\n                walletConnector.walletConnectProvider = null\n              }\n              toastError(t('Authorization Error'), t('Please authorize to access your account'))\n            } else {\n              toastError(error.name, error.message)\n            }\n          }\n        })\n      } else {\n        toastError(t('Unable to find connector'), t('The connector config is wrong'))\n      }\n    },\n    [t, activate, toastError],\n  )\n\n  const logout = useCallback(() => {\n    dispatch(profileClear())\n    deactivate()\n    // This localStorage key is set by @web3-react/walletconnect-connector\n    if (window.localStorage.getItem('walletconnect')) {\n      connectorsByName.walletconnect.close()\n      connectorsByName.walletconnect.walletConnectProvider = null\n    }\n  }, [deactivate, dispatch])\n\n  return { login, logout }\n}\n\nexport default useAuth\n"]},"metadata":{},"sourceType":"module"}