{"ast":null,"code":"import _regeneratorRuntime from\"/Users/nguyenvanhuan243/Documents/apphocvienstock/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/nguyenvanhuan243/Documents/apphocvienstock/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{useCallback}from'react';import{useWeb3React}from'@web3-react/core';import BigNumber from'bignumber.js';import{useAppDispatch}from'state';import{updateUserStakedBalance,updateUserBalance,updateUserPendingReward}from'state/actions';import{unstakeFarm}from'utils/calls';import{useMasterchef,useSousChef}from'hooks/useContract';import{BIG_TEN}from'utils/bigNumber';import getGasPrice from'utils/getGasPrice';var sousUnstake=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(sousChefContract,amount,decimals){var gasPrice,tx,receipt;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:gasPrice=getGasPrice();_context.next=3;return sousChefContract.withdraw(new BigNumber(amount).times(BIG_TEN.pow(decimals)).toString(),{gasPrice:gasPrice});case 3:tx=_context.sent;_context.next=6;return tx.wait();case 6:receipt=_context.sent;return _context.abrupt(\"return\",receipt.status);case 8:case\"end\":return _context.stop();}}},_callee);}));return function sousUnstake(_x,_x2,_x3){return _ref.apply(this,arguments);};}();var sousEmergencyUnstake=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(sousChefContract){var gasPrice,tx,receipt;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:gasPrice=getGasPrice();_context2.next=3;return sousChefContract.emergencyWithdraw({gasPrice:gasPrice});case 3:tx=_context2.sent;_context2.next=6;return tx.wait();case 6:receipt=_context2.sent;return _context2.abrupt(\"return\",receipt.status);case 8:case\"end\":return _context2.stop();}}},_callee2);}));return function sousEmergencyUnstake(_x4){return _ref2.apply(this,arguments);};}();var useUnstakePool=function useUnstakePool(sousId){var enableEmergencyWithdraw=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var dispatch=useAppDispatch();var _useWeb3React=useWeb3React(),account=_useWeb3React.account;var masterChefContract=useMasterchef();var sousChefContract=useSousChef(sousId);var handleUnstake=useCallback(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(amount,decimals){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!(sousId===0)){_context3.next=5;break;}_context3.next=3;return unstakeFarm(masterChefContract,0,amount);case 3:_context3.next=12;break;case 5:if(!enableEmergencyWithdraw){_context3.next=10;break;}_context3.next=8;return sousEmergencyUnstake(sousChefContract);case 8:_context3.next=12;break;case 10:_context3.next=12;return sousUnstake(sousChefContract,amount,decimals);case 12:dispatch(updateUserStakedBalance(sousId,account));dispatch(updateUserBalance(sousId,account));dispatch(updateUserPendingReward(sousId,account));case 15:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x5,_x6){return _ref3.apply(this,arguments);};}(),[account,dispatch,enableEmergencyWithdraw,masterChefContract,sousChefContract,sousId]);return{onUnstake:handleUnstake};};export default useUnstakePool;","map":{"version":3,"sources":["/Users/nguyenvanhuan243/Documents/apphocvienstock/src/views/Pools/hooks/useUnstakePool.ts"],"names":["useCallback","useWeb3React","BigNumber","useAppDispatch","updateUserStakedBalance","updateUserBalance","updateUserPendingReward","unstakeFarm","useMasterchef","useSousChef","BIG_TEN","getGasPrice","sousUnstake","sousChefContract","amount","decimals","gasPrice","withdraw","times","pow","toString","tx","wait","receipt","status","sousEmergencyUnstake","emergencyWithdraw","useUnstakePool","sousId","enableEmergencyWithdraw","dispatch","account","masterChefContract","handleUnstake","onUnstake"],"mappings":"6UAAA,OAASA,WAAT,KAA4B,OAA5B,CACA,OAASC,YAAT,KAA6B,kBAA7B,CACA,MAAOC,CAAAA,SAAP,KAAsB,cAAtB,CACA,OAASC,cAAT,KAA+B,OAA/B,CACA,OAASC,uBAAT,CAAkCC,iBAAlC,CAAqDC,uBAArD,KAAoF,eAApF,CACA,OAASC,WAAT,KAA4B,aAA5B,CACA,OAASC,aAAT,CAAwBC,WAAxB,KAA2C,mBAA3C,CACA,OAASC,OAAT,KAAwB,iBAAxB,CACA,MAAOC,CAAAA,WAAP,KAAwB,mBAAxB,CAEA,GAAMC,CAAAA,WAAW,0FAAG,iBAAOC,gBAAP,CAAyBC,MAAzB,CAAiCC,QAAjC,0IACZC,QADY,CACDL,WAAW,EADV,uBAEDE,CAAAA,gBAAgB,CAACI,QAAjB,CAA0B,GAAIf,CAAAA,SAAJ,CAAcY,MAAd,EAAsBI,KAAtB,CAA4BR,OAAO,CAACS,GAAR,CAAYJ,QAAZ,CAA5B,EAAmDK,QAAnD,EAA1B,CAAyF,CACxGJ,QAAQ,CAARA,QADwG,CAAzF,CAFC,QAEZK,EAFY,qCAKIA,CAAAA,EAAE,CAACC,IAAH,EALJ,QAKZC,OALY,+CAMXA,OAAO,CAACC,MANG,wDAAH,kBAAXZ,CAAAA,WAAW,oDAAjB,CASA,GAAMa,CAAAA,oBAAoB,2FAAG,kBAAOZ,gBAAP,8IACrBG,QADqB,CACVL,WAAW,EADD,wBAEVE,CAAAA,gBAAgB,CAACa,iBAAjB,CAAmC,CAAEV,QAAQ,CAARA,QAAF,CAAnC,CAFU,QAErBK,EAFqB,uCAGLA,CAAAA,EAAE,CAACC,IAAH,EAHK,QAGrBC,OAHqB,iDAIpBA,OAAO,CAACC,MAJY,0DAAH,kBAApBC,CAAAA,oBAAoB,8CAA1B,CAOA,GAAME,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,CAACC,MAAD,CAA6C,IAApCC,CAAAA,uBAAoC,2DAAV,KAAU,CAClE,GAAMC,CAAAA,QAAQ,CAAG3B,cAAc,EAA/B,CACA,kBAAoBF,YAAY,EAAhC,CAAQ8B,OAAR,eAAQA,OAAR,CACA,GAAMC,CAAAA,kBAAkB,CAAGxB,aAAa,EAAxC,CACA,GAAMK,CAAAA,gBAAgB,CAAGJ,WAAW,CAACmB,MAAD,CAApC,CAEA,GAAMK,CAAAA,aAAa,CAAGjC,WAAW,2FAC/B,kBAAOc,MAAP,CAAuBC,QAAvB,2HACMa,MAAM,GAAK,CADjB,kDAEUrB,CAAAA,WAAW,CAACyB,kBAAD,CAAqB,CAArB,CAAwBlB,MAAxB,CAFrB,2CAGae,uBAHb,kDAIUJ,CAAAA,oBAAoB,CAACZ,gBAAD,CAJ9B,gEAMUD,CAAAA,WAAW,CAACC,gBAAD,CAAmBC,MAAnB,CAA2BC,QAA3B,CANrB,SAQEe,QAAQ,CAAC1B,uBAAuB,CAACwB,MAAD,CAASG,OAAT,CAAxB,CAAR,CACAD,QAAQ,CAACzB,iBAAiB,CAACuB,MAAD,CAASG,OAAT,CAAlB,CAAR,CACAD,QAAQ,CAACxB,uBAAuB,CAACsB,MAAD,CAASG,OAAT,CAAxB,CAAR,CAVF,yDAD+B,qEAa/B,CAACA,OAAD,CAAUD,QAAV,CAAoBD,uBAApB,CAA6CG,kBAA7C,CAAiEnB,gBAAjE,CAAmFe,MAAnF,CAb+B,CAAjC,CAgBA,MAAO,CAAEM,SAAS,CAAED,aAAb,CAAP,CACD,CAvBD,CAyBA,cAAeN,CAAAA,cAAf","sourcesContent":["import { useCallback } from 'react'\nimport { useWeb3React } from '@web3-react/core'\nimport BigNumber from 'bignumber.js'\nimport { useAppDispatch } from 'state'\nimport { updateUserStakedBalance, updateUserBalance, updateUserPendingReward } from 'state/actions'\nimport { unstakeFarm } from 'utils/calls'\nimport { useMasterchef, useSousChef } from 'hooks/useContract'\nimport { BIG_TEN } from 'utils/bigNumber'\nimport getGasPrice from 'utils/getGasPrice'\n\nconst sousUnstake = async (sousChefContract, amount, decimals) => {\n  const gasPrice = getGasPrice()\n  const tx = await sousChefContract.withdraw(new BigNumber(amount).times(BIG_TEN.pow(decimals)).toString(), {\n    gasPrice,\n  })\n  const receipt = await tx.wait()\n  return receipt.status\n}\n\nconst sousEmergencyUnstake = async (sousChefContract) => {\n  const gasPrice = getGasPrice()\n  const tx = await sousChefContract.emergencyWithdraw({ gasPrice })\n  const receipt = await tx.wait()\n  return receipt.status\n}\n\nconst useUnstakePool = (sousId, enableEmergencyWithdraw = false) => {\n  const dispatch = useAppDispatch()\n  const { account } = useWeb3React()\n  const masterChefContract = useMasterchef()\n  const sousChefContract = useSousChef(sousId)\n\n  const handleUnstake = useCallback(\n    async (amount: string, decimals: number) => {\n      if (sousId === 0) {\n        await unstakeFarm(masterChefContract, 0, amount)\n      } else if (enableEmergencyWithdraw) {\n        await sousEmergencyUnstake(sousChefContract)\n      } else {\n        await sousUnstake(sousChefContract, amount, decimals)\n      }\n      dispatch(updateUserStakedBalance(sousId, account))\n      dispatch(updateUserBalance(sousId, account))\n      dispatch(updateUserPendingReward(sousId, account))\n    },\n    [account, dispatch, enableEmergencyWithdraw, masterChefContract, sousChefContract, sousId],\n  )\n\n  return { onUnstake: handleUnstake }\n}\n\nexport default useUnstakePool\n"]},"metadata":{},"sourceType":"module"}