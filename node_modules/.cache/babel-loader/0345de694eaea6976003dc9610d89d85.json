{"ast":null,"code":"import _regeneratorRuntime from\"/Users/nguyenvanhuan243/Documents/apphocvienstock/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/nguyenvanhuan243/Documents/apphocvienstock/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/nguyenvanhuan243/Documents/apphocvienstock/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/Users/nguyenvanhuan243/Documents/apphocvienstock/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject,_templateObject2;import React,{useEffect,useState}from'react';import styled from'styled-components';import BigNumber from'bignumber.js';import{useWeb3React}from'@web3-react/core';import{Button,Flex,Text}from'@pancakeswap/uikit';import{getFullDisplayBalance}from'utils/formatBalance';import{getPancakeProfileAddress}from'utils/addressHelpers';import{useCake}from'hooks/useContract';import{useTranslation}from'contexts/Localization';import useGetProfileCosts from'views/Profile/hooks/useGetProfileCosts';import useHasCakeBalance from'hooks/useHasCakeBalance';import{useProfile}from'state/profile/hooks';import ProfileAvatar from'../ProfileAvatar';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var DangerOutline=styled(Button).attrs({variant:'secondary'})(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  border-color: \",\";\\n  color: \",\";\\n  margin-bottom: 24px;\\n\\n  &:hover:not(:disabled):not(.button--disabled):not(:active) {\\n    border-color: \",\";\\n    opacity: 0.8;\\n  }\\n\"])),function(_ref){var theme=_ref.theme;return theme.colors.failure;},function(_ref2){var theme=_ref2.theme;return theme.colors.failure;},function(_ref3){var theme=_ref3.theme;return theme.colors.failure;});var AvatarWrapper=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  height: 64px;\\n  width: 64px;\\n\\n  \",\" {\\n    height: 128px;\\n    width: 128px;\\n  }\\n\"])),function(_ref4){var theme=_ref4.theme;return theme.mediaQueries.sm;});var StartPage=function StartPage(_ref5){var goToApprove=_ref5.goToApprove,goToChange=_ref5.goToChange,goToRemove=_ref5.goToRemove,onDismiss=_ref5.onDismiss;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),needsApproval=_useState2[0],setNeedsApproval=_useState2[1];var _useProfile=useProfile(),profile=_useProfile.profile;var _useGetProfileCosts=useGetProfileCosts(),numberCakeToUpdate=_useGetProfileCosts.numberCakeToUpdate,numberCakeToReactivate=_useGetProfileCosts.numberCakeToReactivate;var minimumCakeRequired=profile.isActive?numberCakeToUpdate:numberCakeToReactivate;var hasMinimumCakeRequired=useHasCakeBalance(minimumCakeRequired);var _useTranslation=useTranslation(),t=_useTranslation.t;var _useWeb3React=useWeb3React(),account=_useWeb3React.account;var cakeContract=useCake();var cost=profile.isActive?numberCakeToUpdate:numberCakeToReactivate;/**\n   * Check if the wallet has the required CAKE allowance to change their profile pic or reactivate\n   * If they don't, we send them to the approval screen first\n   */useEffect(function(){var checkApprovalStatus=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,currentAllowance;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return cakeContract.allowance(account,getPancakeProfileAddress());case 2:response=_context.sent;currentAllowance=new BigNumber(response.toString());setNeedsApproval(currentAllowance.lt(cost));case 5:case\"end\":return _context.stop();}}},_callee);}));return function checkApprovalStatus(){return _ref6.apply(this,arguments);};}();if(account){checkApprovalStatus();}},[account,cost,setNeedsApproval,cakeContract]);if(!profile){return null;}return/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",justifyContent:\"center\",flexDirection:\"column\",children:[/*#__PURE__*/_jsx(AvatarWrapper,{children:/*#__PURE__*/_jsx(ProfileAvatar,{profile:profile})}),/*#__PURE__*/_jsx(Flex,{alignItems:\"center\",style:{height:'48px'},justifyContent:\"center\",children:/*#__PURE__*/_jsx(Text,{as:\"p\",color:\"failure\",children:!hasMinimumCakeRequired&&t('%minimum% CAKE required to change profile pic',{minimum:getFullDisplayBalance(minimumCakeRequired)})})}),profile.isActive?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Button,{width:\"100%\",mb:\"8px\",onClick:needsApproval===true?goToApprove:goToChange,disabled:!hasMinimumCakeRequired||needsApproval===null,children:t('Change Profile Pic')}),/*#__PURE__*/_jsx(DangerOutline,{width:\"100%\",onClick:goToRemove,children:t('Remove Profile Pic')})]}):/*#__PURE__*/_jsx(Button,{width:\"100%\",mb:\"8px\",onClick:needsApproval===true?goToApprove:goToChange,disabled:!hasMinimumCakeRequired||needsApproval===null,children:t('Reactivate Profile')}),/*#__PURE__*/_jsx(Button,{variant:\"text\",width:\"100%\",onClick:onDismiss,children:t('Close Window')})]});};export default StartPage;","map":{"version":3,"sources":["/Users/nguyenvanhuan243/Documents/apphocvienstock/src/views/Profile/components/EditProfileModal/StartView.tsx"],"names":["React","useEffect","useState","styled","BigNumber","useWeb3React","Button","Flex","Text","getFullDisplayBalance","getPancakeProfileAddress","useCake","useTranslation","useGetProfileCosts","useHasCakeBalance","useProfile","ProfileAvatar","DangerOutline","attrs","variant","theme","colors","failure","AvatarWrapper","div","mediaQueries","sm","StartPage","goToApprove","goToChange","goToRemove","onDismiss","needsApproval","setNeedsApproval","profile","numberCakeToUpdate","numberCakeToReactivate","minimumCakeRequired","isActive","hasMinimumCakeRequired","t","account","cakeContract","cost","checkApprovalStatus","allowance","response","currentAllowance","toString","lt","height","minimum"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport styled from 'styled-components'\nimport BigNumber from 'bignumber.js'\nimport { useWeb3React } from '@web3-react/core'\nimport { Button, Flex, Text, InjectedModalProps } from '@pancakeswap/uikit'\nimport { getFullDisplayBalance } from 'utils/formatBalance'\nimport { getPancakeProfileAddress } from 'utils/addressHelpers'\nimport { useCake } from 'hooks/useContract'\nimport { useTranslation } from 'contexts/Localization'\nimport useGetProfileCosts from 'views/Profile/hooks/useGetProfileCosts'\nimport useHasCakeBalance from 'hooks/useHasCakeBalance'\nimport { useProfile } from 'state/profile/hooks'\nimport { UseEditProfileResponse } from './reducer'\nimport ProfileAvatar from '../ProfileAvatar'\n\ninterface StartPageProps extends InjectedModalProps {\n  goToChange: UseEditProfileResponse['goToChange']\n  goToRemove: UseEditProfileResponse['goToRemove']\n  goToApprove: UseEditProfileResponse['goToApprove']\n}\n\nconst DangerOutline = styled(Button).attrs({ variant: 'secondary' })`\n  border-color: ${({ theme }) => theme.colors.failure};\n  color: ${({ theme }) => theme.colors.failure};\n  margin-bottom: 24px;\n\n  &:hover:not(:disabled):not(.button--disabled):not(:active) {\n    border-color: ${({ theme }) => theme.colors.failure};\n    opacity: 0.8;\n  }\n`\n\nconst AvatarWrapper = styled.div`\n  height: 64px;\n  width: 64px;\n\n  ${({ theme }) => theme.mediaQueries.sm} {\n    height: 128px;\n    width: 128px;\n  }\n`\n\nconst StartPage: React.FC<StartPageProps> = ({ goToApprove, goToChange, goToRemove, onDismiss }) => {\n  const [needsApproval, setNeedsApproval] = useState(null)\n  const { profile } = useProfile()\n  const { numberCakeToUpdate, numberCakeToReactivate } = useGetProfileCosts()\n  const minimumCakeRequired = profile.isActive ? numberCakeToUpdate : numberCakeToReactivate\n  const hasMinimumCakeRequired = useHasCakeBalance(minimumCakeRequired)\n  const { t } = useTranslation()\n  const { account } = useWeb3React()\n  const cakeContract = useCake()\n  const cost = profile.isActive ? numberCakeToUpdate : numberCakeToReactivate\n\n  /**\n   * Check if the wallet has the required CAKE allowance to change their profile pic or reactivate\n   * If they don't, we send them to the approval screen first\n   */\n  useEffect(() => {\n    const checkApprovalStatus = async () => {\n      const response = await cakeContract.allowance(account, getPancakeProfileAddress())\n      const currentAllowance = new BigNumber(response.toString())\n      setNeedsApproval(currentAllowance.lt(cost))\n    }\n\n    if (account) {\n      checkApprovalStatus()\n    }\n  }, [account, cost, setNeedsApproval, cakeContract])\n\n  if (!profile) {\n    return null\n  }\n\n  return (\n    <Flex alignItems=\"center\" justifyContent=\"center\" flexDirection=\"column\">\n      <AvatarWrapper>\n        <ProfileAvatar profile={profile} />\n      </AvatarWrapper>\n      <Flex alignItems=\"center\" style={{ height: '48px' }} justifyContent=\"center\">\n        <Text as=\"p\" color=\"failure\">\n          {!hasMinimumCakeRequired &&\n            t('%minimum% CAKE required to change profile pic', { minimum: getFullDisplayBalance(minimumCakeRequired) })}\n        </Text>\n      </Flex>\n      {profile.isActive ? (\n        <>\n          <Button\n            width=\"100%\"\n            mb=\"8px\"\n            onClick={needsApproval === true ? goToApprove : goToChange}\n            disabled={!hasMinimumCakeRequired || needsApproval === null}\n          >\n            {t('Change Profile Pic')}\n          </Button>\n          <DangerOutline width=\"100%\" onClick={goToRemove}>\n            {t('Remove Profile Pic')}\n          </DangerOutline>\n        </>\n      ) : (\n        <Button\n          width=\"100%\"\n          mb=\"8px\"\n          onClick={needsApproval === true ? goToApprove : goToChange}\n          disabled={!hasMinimumCakeRequired || needsApproval === null}\n        >\n          {t('Reactivate Profile')}\n        </Button>\n      )}\n      <Button variant=\"text\" width=\"100%\" onClick={onDismiss}>\n        {t('Close Window')}\n      </Button>\n    </Flex>\n  )\n}\n\nexport default StartPage\n"]},"metadata":{},"sourceType":"module"}