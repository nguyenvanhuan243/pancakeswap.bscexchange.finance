{"ast":null,"code":"import _regeneratorRuntime from\"/Users/nguyenvanhuan243/Documents/apphocvienstock/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/nguyenvanhuan243/Documents/apphocvienstock/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/nguyenvanhuan243/Documents/apphocvienstock/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/Users/nguyenvanhuan243/Documents/apphocvienstock/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject,_templateObject2;import React,{useContext,useState}from'react';import styled from'styled-components';import{AutoRenewIcon,Button,Card,CardBody,Heading,Skeleton,Text}from'@pancakeswap/uikit';import{useWeb3React}from'@web3-react/core';import{Link as RouterLink}from'react-router-dom';import{getAddressByType}from'utils/collectibles';import{getPancakeProfileAddress}from'utils/addressHelpers';import{getErc721Contract}from'utils/contractHelpers';import{useTranslation}from'contexts/Localization';import{useGetCollectibles}from'state/collectibles/hooks';import useToast from'hooks/useToast';import{useCallWithGasPrice}from'hooks/useCallWithGasPrice';import SelectionCard from'../components/SelectionCard';import NextStepButton from'../components/NextStepButton';import{ProfileCreationContext}from'./contexts/ProfileCreationProvider';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Link=styled(RouterLink)(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  color: \",\";\\n\"])),function(_ref){var theme=_ref.theme;return theme.colors.primary;});var NftWrapper=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  margin-bottom: 24px;\\n\"])));var ProfilePicture=function ProfilePicture(){var _useWeb3React=useWeb3React(),library=_useWeb3React.library;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isApproved=_useState2[0],setIsApproved=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isApproving=_useState4[0],setIsApproving=_useState4[1];var _useContext=useContext(ProfileCreationContext),selectedNft=_useContext.selectedNft,actions=_useContext.actions;var _useTranslation=useTranslation(),t=_useTranslation.t;var _useGetCollectibles=useGetCollectibles(),isLoading=_useGetCollectibles.isLoading,nftsInWallet=_useGetCollectibles.nftsInWallet,tokenIds=_useGetCollectibles.tokenIds;var _useToast=useToast(),toastError=_useToast.toastError;var _useCallWithGasPrice=useCallWithGasPrice(),callWithGasPrice=_useCallWithGasPrice.callWithGasPrice;var handleApprove=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var contract,tx,receipt;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:contract=getErc721Contract(selectedNft.nftAddress,library.getSigner());_context.next=3;return callWithGasPrice(contract,'approve',[getPancakeProfileAddress(),selectedNft.tokenId]);case 3:tx=_context.sent;setIsApproving(true);_context.next=7;return tx.wait();case 7:receipt=_context.sent;if(receipt.status){setIsApproving(false);setIsApproved(true);}else{toastError(t('Error'),t('Please try again. Confirm the transaction and make sure you are paying enough gas!'));setIsApproving(false);}case 9:case\"end\":return _context.stop();}}},_callee);}));return function handleApprove(){return _ref2.apply(this,arguments);};}();if(!isLoading&&nftsInWallet.length===0){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Heading,{scale:\"xl\",mb:\"24px\",children:t('Oops!')}),/*#__PURE__*/_jsx(Text,{bold:true,fontSize:\"20px\",mb:\"24px\",children:t('We couldn’t find any Pancake Collectibles in your wallet.')}),/*#__PURE__*/_jsx(Text,{as:\"p\",children:t('You need a Pancake Collectible to finish setting up your profile. If you sold or transferred your starter collectible to another wallet, you’ll need to get it back or acquire a new one somehow. You can’t make a new starter with this wallet address.')})]});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Text,{fontSize:\"20px\",color:\"textSubtle\",bold:true,children:t('Step %num%',{num:2})}),/*#__PURE__*/_jsx(Heading,{as:\"h3\",scale:\"xl\",mb:\"24px\",children:t('Set Profile Picture')}),/*#__PURE__*/_jsx(Card,{mb:\"24px\",children:/*#__PURE__*/_jsxs(CardBody,{children:[/*#__PURE__*/_jsx(Heading,{as:\"h4\",scale:\"lg\",mb:\"8px\",children:t('Choose collectible')}),/*#__PURE__*/_jsx(Text,{as:\"p\",color:\"textSubtle\",children:t('Choose a profile picture from the eligible collectibles (NFT) in your wallet, shown below.')}),/*#__PURE__*/_jsxs(Text,{as:\"p\",color:\"textSubtle\",mb:\"24px\",children:[t('Only approved Pancake Collectibles can be used.'),/*#__PURE__*/_jsx(Link,{to:\"/collectibles\",style:{marginLeft:'4px'},children:t('See the list >')})]}),/*#__PURE__*/_jsx(NftWrapper,{children:isLoading?/*#__PURE__*/_jsx(Skeleton,{height:\"80px\",mb:\"16px\"}):nftsInWallet.map(function(walletNft){var _tokenIds$walletNft$i=_slicedToArray(tokenIds[walletNft.identifier],1),firstTokenId=_tokenIds$walletNft$i[0];var address=getAddressByType(walletNft.type);return/*#__PURE__*/_jsx(SelectionCard,{name:\"profilePicture\",value:firstTokenId,image:\"/images/nfts/\".concat(walletNft.images.md),isChecked:firstTokenId===selectedNft.tokenId,onChange:function onChange(value){return actions.setSelectedNft(parseInt(value,10),address);},children:/*#__PURE__*/_jsx(Text,{bold:true,children:walletNft.name})},walletNft.identifier);})}),/*#__PURE__*/_jsx(Heading,{as:\"h4\",scale:\"lg\",mb:\"8px\",children:t('Allow collectible to be locked')}),/*#__PURE__*/_jsx(Text,{as:\"p\",color:\"textSubtle\",mb:\"16px\",children:t(\"The collectible you've chosen will be locked in a smart contract while it’s being used as your profile picture. Don't worry - you'll be able to get it back at any time.\")}),/*#__PURE__*/_jsx(Button,{isLoading:isApproving,disabled:isApproved||isApproving||selectedNft.tokenId===null,onClick:handleApprove,endIcon:isApproving?/*#__PURE__*/_jsx(AutoRenewIcon,{spin:true,color:\"currentColor\"}):undefined,id:\"approveStarterCollectible\",children:t('Enable')})]})}),/*#__PURE__*/_jsx(NextStepButton,{onClick:actions.nextStep,disabled:selectedNft.tokenId===null||!isApproved||isApproving,children:t('Next Step')})]});};export default ProfilePicture;","map":{"version":3,"sources":["/Users/nguyenvanhuan243/Documents/apphocvienstock/src/views/Profile/ProfileCreation/ProfilePicture.tsx"],"names":["React","useContext","useState","styled","AutoRenewIcon","Button","Card","CardBody","Heading","Skeleton","Text","useWeb3React","Link","RouterLink","getAddressByType","getPancakeProfileAddress","getErc721Contract","useTranslation","useGetCollectibles","useToast","useCallWithGasPrice","SelectionCard","NextStepButton","ProfileCreationContext","theme","colors","primary","NftWrapper","div","ProfilePicture","library","isApproved","setIsApproved","isApproving","setIsApproving","selectedNft","actions","t","isLoading","nftsInWallet","tokenIds","toastError","callWithGasPrice","handleApprove","contract","nftAddress","getSigner","tokenId","tx","wait","receipt","status","length","num","marginLeft","map","walletNft","identifier","firstTokenId","address","type","images","md","value","setSelectedNft","parseInt","name","undefined","nextStep"],"mappings":"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","sourcesContent":["import React, { useContext, useState } from 'react'\nimport styled from 'styled-components'\nimport { AutoRenewIcon, Button, Card, CardBody, Heading, Skeleton, Text } from '@pancakeswap/uikit'\nimport { useWeb3React } from '@web3-react/core'\nimport { Link as RouterLink } from 'react-router-dom'\nimport { getAddressByType } from 'utils/collectibles'\nimport { getPancakeProfileAddress } from 'utils/addressHelpers'\nimport { getErc721Contract } from 'utils/contractHelpers'\nimport { useTranslation } from 'contexts/Localization'\nimport { useGetCollectibles } from 'state/collectibles/hooks'\nimport useToast from 'hooks/useToast'\nimport { useCallWithGasPrice } from 'hooks/useCallWithGasPrice'\nimport SelectionCard from '../components/SelectionCard'\nimport NextStepButton from '../components/NextStepButton'\nimport { ProfileCreationContext } from './contexts/ProfileCreationProvider'\n\nconst Link = styled(RouterLink)`\n  color: ${({ theme }) => theme.colors.primary};\n`\n\nconst NftWrapper = styled.div`\n  margin-bottom: 24px;\n`\n\nconst ProfilePicture: React.FC = () => {\n  const { library } = useWeb3React()\n  const [isApproved, setIsApproved] = useState(false)\n  const [isApproving, setIsApproving] = useState(false)\n  const { selectedNft, actions } = useContext(ProfileCreationContext)\n\n  const { t } = useTranslation()\n  const { isLoading, nftsInWallet, tokenIds } = useGetCollectibles()\n  const { toastError } = useToast()\n  const { callWithGasPrice } = useCallWithGasPrice()\n\n  const handleApprove = async () => {\n    const contract = getErc721Contract(selectedNft.nftAddress, library.getSigner())\n    const tx = await callWithGasPrice(contract, 'approve', [getPancakeProfileAddress(), selectedNft.tokenId])\n    setIsApproving(true)\n    const receipt = await tx.wait()\n    if (receipt.status) {\n      setIsApproving(false)\n      setIsApproved(true)\n    } else {\n      toastError(t('Error'), t('Please try again. Confirm the transaction and make sure you are paying enough gas!'))\n      setIsApproving(false)\n    }\n  }\n\n  if (!isLoading && nftsInWallet.length === 0) {\n    return (\n      <>\n        <Heading scale=\"xl\" mb=\"24px\">\n          {t('Oops!')}\n        </Heading>\n        <Text bold fontSize=\"20px\" mb=\"24px\">\n          {t('We couldn’t find any Pancake Collectibles in your wallet.')}\n        </Text>\n        <Text as=\"p\">\n          {t(\n            'You need a Pancake Collectible to finish setting up your profile. If you sold or transferred your starter collectible to another wallet, you’ll need to get it back or acquire a new one somehow. You can’t make a new starter with this wallet address.',\n          )}\n        </Text>\n      </>\n    )\n  }\n\n  return (\n    <>\n      <Text fontSize=\"20px\" color=\"textSubtle\" bold>\n        {t('Step %num%', { num: 2 })}\n      </Text>\n      <Heading as=\"h3\" scale=\"xl\" mb=\"24px\">\n        {t('Set Profile Picture')}\n      </Heading>\n      <Card mb=\"24px\">\n        <CardBody>\n          <Heading as=\"h4\" scale=\"lg\" mb=\"8px\">\n            {t('Choose collectible')}\n          </Heading>\n          <Text as=\"p\" color=\"textSubtle\">\n            {t('Choose a profile picture from the eligible collectibles (NFT) in your wallet, shown below.')}\n          </Text>\n          <Text as=\"p\" color=\"textSubtle\" mb=\"24px\">\n            {t('Only approved Pancake Collectibles can be used.')}\n            <Link to=\"/collectibles\" style={{ marginLeft: '4px' }}>\n              {t('See the list >')}\n            </Link>\n          </Text>\n          <NftWrapper>\n            {isLoading ? (\n              <Skeleton height=\"80px\" mb=\"16px\" />\n            ) : (\n              nftsInWallet.map((walletNft) => {\n                const [firstTokenId] = tokenIds[walletNft.identifier]\n                const address = getAddressByType(walletNft.type)\n\n                return (\n                  <SelectionCard\n                    name=\"profilePicture\"\n                    key={walletNft.identifier}\n                    value={firstTokenId}\n                    image={`/images/nfts/${walletNft.images.md}`}\n                    isChecked={firstTokenId === selectedNft.tokenId}\n                    onChange={(value: string) => actions.setSelectedNft(parseInt(value, 10), address)}\n                  >\n                    <Text bold>{walletNft.name}</Text>\n                  </SelectionCard>\n                )\n              })\n            )}\n          </NftWrapper>\n          <Heading as=\"h4\" scale=\"lg\" mb=\"8px\">\n            {t('Allow collectible to be locked')}\n          </Heading>\n          <Text as=\"p\" color=\"textSubtle\" mb=\"16px\">\n            {t(\n              \"The collectible you've chosen will be locked in a smart contract while it’s being used as your profile picture. Don't worry - you'll be able to get it back at any time.\",\n            )}\n          </Text>\n          <Button\n            isLoading={isApproving}\n            disabled={isApproved || isApproving || selectedNft.tokenId === null}\n            onClick={handleApprove}\n            endIcon={isApproving ? <AutoRenewIcon spin color=\"currentColor\" /> : undefined}\n            id=\"approveStarterCollectible\"\n          >\n            {t('Enable')}\n          </Button>\n        </CardBody>\n      </Card>\n      <NextStepButton onClick={actions.nextStep} disabled={selectedNft.tokenId === null || !isApproved || isApproving}>\n        {t('Next Step')}\n      </NextStepButton>\n    </>\n  )\n}\n\nexport default ProfilePicture\n"]},"metadata":{},"sourceType":"module"}